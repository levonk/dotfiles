{{- /* chezmoi:modify-template */ -}}
{{- if (stat .chezmoi.targetFile) -}}
{{ $configBlock := `
############################################################################
# Defaults

# Configuration data is parsed as follows:
#  1. command line options
#  2. user-specific file
#  3. system-wide file
# Any configuration value is only changed the first time it is set.
# Thus, host-specific definitions should be at the beginning of the
# configuration file, and defaults at the end.

Host github.com
	User git
	ForwardAgent no
	ForwardX11 no
	Compression yes

Host host-behind-gateway
	ForwardAgent yes
	ForwardX11 yes
	ProxyCommand ssh gateway-host nc %h %p

Host gateway-host
	Port 2222
	StrictHostKeyChecking yes
	ForwardAgent yes
	ForwardX11 yes

Host domU*.compute-1.internal
	UserKnownHostsFile /dev/null
	StrictHostKeyChecking no
	ForwardAgent no
	ForwardX11 no
	Compression yes

Host ec2-*.us-west-1.compute.amazonaws.com.
	UserKnownHostsFile /dev/null
	StrictHostKeyChecking no
	ForwardAgent no
	ForwardX11 no
	Compression yes

Host ec2-*.compute-1.amazonaws.com.
	UserKnownHostsFile /dev/null
	StrictHostKeyChecking no
	ForwardAgent no
	ForwardX11 no
	Compression yes

Host *
	ForwardAgent no
	ForwardX11 no
	Compression yes
` }}
{{- $fileContent := "" -}}
{{- if hasKey .chezmoi "stdin" -}}
  {{- $fileContent = .chezmoi.stdin -}}
{{- end -}}

{{ if not (contains $fileContent $configBlock) -}}
{{ $fileContent }}
{{ $configBlock }}
{{ end }}
{{- else -}}
{{ $configBlock := `
############################################################################
# Defaults

# Configuration data is parsed as follows:
#  1. command line options
#  2. user-specific file
#  3. system-wide file
# Any configuration value is only changed the first time it is set.
# Thus, host-specific definitions should be at the beginning of the
# configuration file, and defaults at the end.

Host github.com
	User git
	ForwardAgent no
	ForwardX11 no
	Compression yes

Host *
	ForwardAgent no
	ForwardX11 no
	Compression yes
` }}
{{ $configBlock }}
{{- end -}}
