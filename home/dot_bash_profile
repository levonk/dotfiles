# =====================================================================
# Bash Config (XDG-Compliant Version)
# Managed by chezmoi | https://github.com/levonk/dotfiles
#
# Purpose:
# Standard Order for Login shell: `/etc/profile`, `~/.bash_profile`, `~/.bash_login`, `~/.profile`
# Standard Interactive NON-login shell: `~/.bashrc`
# Standard NON-Interactive Script: `~/bash_env`
#
# This version moves bashrc to XDG-compliant location while maintaining compatibility
# Compliance: See LICENSE and admin/licenses.md
# =====================================================================

# Source XDG Base Directory variables from the centralized location
# This ensures a single source of truth for XDG environment variables
XDG_DIRS_ENV="$HOME/.config/shells/shared/env/__xdg-env.sh"
if [ -r "$XDG_DIRS_ENV" ]; then
    . "$XDG_DIRS_ENV"
else
    echo "Warning: Could not source XDG environment variables from $XDG_DIRS_ENV" >&2
    # Fallback XDG variables if the dedicated file is not available
    export XDG_DATA_HOME="${XDG_DATA_HOME:-$HOME/.local/share}"
    export XDG_CONFIG_HOME="${XDG_CONFIG_HOME:-$HOME/.config}"
    export XDG_STATE_HOME="${XDG_STATE_HOME:-$HOME/.local/state}"
    export XDG_CACHE_HOME="${XDG_CACHE_HOME:-$HOME/.cache}"
    export XDG_BIN_HOME="${XDG_BIN_HOME:-$HOME/.local/bin}"
fi

# Source bashrc from XDG-compliant location with fallback to traditional location
BASHRC_XDG="${XDG_CONFIG_HOME:-$HOME/.config}/shells/bash/bashrc"
BASHRC_TRADITIONAL="$HOME/.bashrc"

if [ -r "$BASHRC_XDG" ]; then
    # Use XDG-compliant location (preferred)
    source "$BASHRC_XDG"
elif [ -r "$BASHRC_TRADITIONAL" ]; then
    # Fallback to traditional location for compatibility
    source "$BASHRC_TRADITIONAL"
    echo "Info: Using traditional ~/.bashrc location. Consider migrating to $BASHRC_XDG" >&2
else
    echo "Warning: No bashrc found in either $BASHRC_XDG or $BASHRC_TRADITIONAL" >&2
fi
