# Byobu (tmux backend) user configuration
# This file lives in ~/.byobu/tmux.conf
# Note: Byobu does not natively follow XDG base dirs. To keep config under XDG:
#   mkdir -p "$XDG_CONFIG_HOME/byobu" && ln -sfn "$XDG_CONFIG_HOME/byobu" "$HOME/.byobu"
# Then place this file under $XDG_CONFIG_HOME/byobu/tmux.conf

# --- Reuse plain tmux config (keep below Byobu-specific tweaks) ---
# This pulls in your ~/.tmux.conf (managed by chezmoi: home/dot_tmux.conf)
source-file ~/.tmux.conf

# --- Encoding & color ---
# Use a 256-color capable terminal; Byobu often sets screen-256color already
set -g default-terminal "screen-256color"
# Enable truecolor for terminals that support it
set -ga terminal-overrides ',xterm-256color:RGB,screen-256color:Tc'

# --- History & panes ---
set -g history-limit 10000            # similar to screen's defscrollback 10000
setw -g aggressive-resize on          # let panes resize to the terminal
set -g escape-time 0                  # snappier key handling
set -g remain-on-exit on              # like screen's zombie, keep pane after exit

# --- Mouse (optional) ---
# Enables pane resize, selection, and copy with mouse. Disable if undesired.
set -g mouse on

# --- Copy-mode & keys ---
# Vi-style keys in copy-mode/search; comment if you prefer emacs
setw -g mode-keys vi
set -g status-keys vi

# --- Key bindings parity with ~/.tmux.conf ---
# Split panes using | and - (unbind default % and ")
bind | split-window -h
bind - split-window -v
unbind '"'
unbind %

# Reload config
bind r source-file ~/.tmux.conf \; display-message "Config reloaded!"

# Pane navigation with Alt-arrows (no prefix)
bind -n M-Left select-pane -L
bind -n M-Right select-pane -R
bind -n M-Up select-pane -U
bind -n M-Down select-pane -D

# Vi-style pane navigation
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# Vi-style window navigation
bind -r C-h select-window -t :-
bind -r C-l select-window -t :+

# Resize with H/J/K/L
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

# --- Activity & bell (visual only) ---
set -g monitor-activity on
set -g visual-activity on
set -g visual-bell on
set -g bell-action any

# --- Window/Pane titles ---
# Auto title: show current command basename in window name
set -g automatic-rename on
set -g automatic-rename-format '#{b:pane_current_command}'
# Session/window status strings (Byobu draws its own status; these are safe fallbacks)
set -g set-titles on
set -g set-titles-string 'tmux:#S #I:#W â€” #H'

# --- Status line (compact, 256-color aware) ---
# Byobu typically controls the status; leave tmux status on but minimal
set -g status on
set -g status-interval 5
set -g status-style bg=black,fg=white
setw -g window-status-current-format '#[bold]#I:#W*'
setw -g window-status-format ' #I:#W '

# --- Prefix / compatibility ---
# Byobu defaults to tmux prefix C-b (same as your screen escape ^B)
# If you ever change Byobu's prefix, keep this file in sync.

# --- Logging (manual) ---
# Example: start per-pane logging when needed (manually)
# bind-key L pipe-pane -o 'cat >> #{pane_title:-pane}-#{session_name}-#{window_index}.log'
