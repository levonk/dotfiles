# Robustly check if the script is being sourced
_am_i_sourced() {
    # If BASH_SOURCE is set and the first element is not this script, it's sourced.
    # Or if ZSH_EVAL_CONTEXT is 'toplevel' or 'file', it's not top-level sourced.
    [ -n "${BASH_SOURCE[0]}" ] && [ "${BASH_SOURCE[0]}" != "$0" ] || \
    [ -n "${ZSH_EVAL_CONTEXT}" ] && [[ "$ZSH_EVAL_CONTEXT" != "toplevel" && "$ZSH_EVAL_CONTEXT" != "file" ]]
}

if ! _am_i_sourced; then
    # This means the script was executed directly.
    echo "WARNING: This .sh script should be sourced, not executed. Path: '$0'" >&2
fi

unset -f _am_i_sourced
